{% extends "base.html" %}

{% block title %}Dashboard de {{ user.username }}{% endblock %}

{% block content %}
    <h2>Bem-vindo, {{ user.username }}!</h2>
    <p>
        <a href="{{ url_for('add_task') }}" class="button-link">Adicionar Nova Tarefa</a>
    </p>

    <h3>Minhas Tarefas</h3>
    {% if tasks %}
        <ul>
            {% for task in tasks %}
                <li class="{{ 'completed' if task.is_completed }}">
                    <div class="task-info">
                        <strong>{{ task.title }}</strong>
                        <p>{{ task.description }}</p>
                        <small>Prioridade: {{ task.priority | capitalize }} | Data Limite: {{ task.due_date.strftime('%Y-%m-%d') }} | Categoria: {{ task.category }}</small>
                    </div>
                    <div class="action-buttons">
                        {# Botões de ação, visíveis apenas para o proprietário da tarefa (já garantido pelo login_required) #}
                        <a href="{{ url_for('edit_task', task_id=task.id) }}">Editar</a>
                        <a href="{{ url_for('delete_task', task_id=task.id) }}" class="delete-button" onclick="return confirm('Tem certeza que deseja apagar esta tarefa?');">Apagar</a>
                        {% if task.is_completed %}
                            <a href="{{ url_for('mark_task_undone', task_id=task.id) }}">Desmarcar Concluída</a>
                        {% else %}
                            <a href="{{ url_for('mark_task_done', task_id=task.id) }}">Marcar Concluída</a>
                        {% endif %}
                    </div>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>Nenhuma tarefa encontrada.</p>
    {% endif %}
{% endblock %}